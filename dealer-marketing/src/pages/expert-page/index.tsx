import React, { useContext, useEffect } from "react";
import Script from "next/script";
import axios from "axios";
import Head from "next/head";

// components
import { Navigation, Text } from "@components/common";
import { ExpertList } from "@components";

// constants
import { EXPERT_URL } from "@constants/url";

// layouts
import Header from "@layouts/Header";
import Footer from "@layouts/Footer";

import { Expert } from "@common-types/expert";
import { DataContext } from "@context/DataContext";
import style from "../../styles/base/common.module.css";
import { EXPERT_RESPONSE_DATA } from "@api-backup/expertResponseData";

interface OurExpertProps {
  experts: Expert[];
  errorCode: string;
}

export const getStaticProps = async () => {
  try {
    // const res = await axios.get(EXPERT_URL);
    // const experts = res.data;
    const experts: Expert[] = EXPERT_RESPONSE_DATA;
    return {
      props: {
        experts: experts,
        errorCode: false,
      },
    };
  } catch (errorCode) {
    return {
      props: {
        experts: [],
        errorCode: errorCode,
      },
    };
  }
};

const OurExpertPage: React.FC<OurExpertProps> = ({ experts, errorCode }) => {
  const { setExperts, setErrorCode } = useContext(DataContext);
  useEffect(() => {
    setExperts(experts);
    setErrorCode(errorCode);
  }, []);

  return (
    <div className={style["style-our-expert"]}>
      <Head>
        {/* Google Tag Manager */}
        <Script
          strategy="afterInteractive"
          type="text/partytown"
          dangerouslySetInnerHTML={{
            __html: `(function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
            var f = d.getElementsByTagName(s)[0],
              j = d.createElement(s),
              dl = l != "dataLayer" ? "&l=" + l : "";
            j.async = true;
            j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
            f.parentNode.insertBefore(j, f);
          })(window, document, "script", "dataLayer", "GTM-WK9ZN93")`,
          }}></Script>
        {/* End Google Tag Manager */}
        <title>Dealer Marketing</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Header />
      <div className={style["style-navigation"]}>
        <Navigation />
      </div>
      <div className={style["style-description"]}>
        <h2 className={style["style-heading"]}>The DMM Expert Panel</h2>
        <Text
          size="regular"
          text="Our Expert Panel consists of thirty automotive industry experts who share their knowledge and experience to help keep dealers informed on various topics such as Business Development, Dealership Business, Fixed Ops, Internet Marketing, Advertising, AI, Tech Solutions, Industry & Consumer Research, and more. With a combined LinkedIn following of 113,000+ followers, as an automotive industry professional or vendor, you are guaranteed to learn something new."
        />
      </div>
      <div className={style["style-expert"]}>
        <ExpertList />
      </div>
      <Footer />
    </div>
  );
};

export default OurExpertPage;
